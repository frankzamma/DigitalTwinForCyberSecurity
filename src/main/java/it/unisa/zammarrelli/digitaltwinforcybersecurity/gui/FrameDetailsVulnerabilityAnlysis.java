package it.unisa.zammarrelli.digitaltwinforcybersecurity.gui;

import com.intellij.openapi.ui.popup.JBPopup;
import com.intellij.openapi.ui.popup.JBPopupFactory;
import com.intellij.ui.components.JBLabel;
import it.unisa.zammarrelli.digitaltwinforcybersecurity.common.Vulnerability;

import javax.swing.*;
import java.awt.*;

public class FrameDetailsVulnerabilityAnlysis extends JFrame {
    private Vulnerability v;

    public FrameDetailsVulnerabilityAnlysis(Vulnerability vulnerability) throws HeadlessException {
        this.v = vulnerability;

        super.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        createContent();
    }

    private void createContent(){
        JPanel panelDetails = new JPanel();
        panelDetails.setLayout(new BoxLayout(panelDetails, BoxLayout.Y_AXIS));

        JPanel panelName =  new JPanel(new FlowLayout(FlowLayout.LEFT));
        panelName.add(new JBLabel("Name:"));
        panelName.add(new JBLabel(v.getName()));

        panelDetails.add(panelName);

        JPanel panelDescription = new JPanel(new FlowLayout(FlowLayout.LEFT));
        panelDescription.add(new JBLabel("Description:"));
        panelDescription.add(new JBLabel(v.getDescription()));

        panelDetails.add(panelDescription);

        JPanel panelLine = new JPanel(new FlowLayout(FlowLayout.LEFT));
        panelLine.add(new JBLabel("Line:"));
        panelLine.add(new JBLabel(Integer.toString(v.getLine())));

        panelDetails.add(panelLine);

        JPanel panelSeverity =  new JPanel(new FlowLayout(FlowLayout.LEFT));
        panelSeverity.add(new JBLabel("Severity:"));
        panelSeverity.add(new JBLabel(v.getSeverity()));

        panelDetails.add(panelSeverity);


        JPanel panelSolution = new JPanel(new FlowLayout(FlowLayout.LEFT));
        panelSolution.add(new JBLabel("Solution:\n" + v.getSolution()));

        panelDetails.add(panelSolution);

        if(v.getExampleSolutionCode().length() > 0){
            JPanel panelExampleCodeSolution = new JPanel(new FlowLayout(FlowLayout.LEFT));
            panelExampleCodeSolution.add(new JBLabel("<html>Example code solution:<br><code>"
                    + v.getExampleSolutionCode().replaceAll("\n", "<br>") + "</html>").setCopyable(true));

            panelDetails.add(panelExampleCodeSolution);
        }

        super.add(panelDetails);
        super.pack();
        super.setLocationRelativeTo(null);
        super.setResizable(false);
    }



}
